/*! multi-event 2015-09-02 */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function eventType(a){var b={valid:!1,type:"mono",splited:[]};b.splited=a.split(".");var c=!0,d=!1,e=void 0;try{for(var f,g=b.splited[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=/^[a-z0-9]+$/i.test(h),j="*"===h;if(!i&&!j)return b;j&&(b.type="multi")}}catch(k){d=!0,e=k}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}return b.valid=!0,b.name=a,b}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Eventy=function(){function a(){_classCallCheck(this,a),this._events={},this._multiEvents={},this._mapMonoMulti={}}return _createClass(a,[{key:"getNamesMatchs",value:function(a){var b=Object.keys(this._events),c=b.filter(function(b){var c=b.split(".");if(a.length!==c.length)return!1;for(var d in a)if("*"!==a[d]&&c[d]!==a[d])return!1;return!0});return c}},{key:"on",value:function(a,b){var c=eventType(a);if(!c.valid)throw"invalid name";if("function"!=typeof b)throw"you must give me a function";var d=this._events;return"multi"===c.type&&(d=this._multiEvents),d[a]=d[a]||[],-1===d[a].indexOf(b)&&(d[a].push(b),"multi"===c.type&&this.updateMapSet(c)),this}},{key:"updateMapSet",value:function(a){var b=this.getNamesMatchs(a.splited),c=!0,d=!1,e=void 0;try{for(var f,g=b[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=this._mapMonoMulti[h]=this._mapMonoMulti[h]||new Set;i.add(a.name)}}catch(j){d=!0,e=j}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}}},{key:"emit",value:function(a){var b=this,c=eventType(a);if(!c.valid)throw"invalid event";if("multi"===c.type)throw"you can not emit multiple events, may be in the next version";var d=[];Array.prototype.push.apply(d,this._events[a]||[]);var e=this._mapMonoMulti[a];if(e){var f=!0,g=!1,h=void 0;try{for(var i,j=e[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value,l=b._multiEvents[k];Array.prototype.push.apply(d,l)}}catch(m){g=!0,h=m}finally{try{!f&&j["return"]&&j["return"]()}finally{if(g)throw h}}}var n=!0,o=!1,p=void 0;try{for(var q=arguments.length,r=Array(q>1?q-1:0),s=1;q>s;s++)r[s-1]=arguments[s];for(var t,u=d[Symbol.iterator]();!(n=(t=u.next()).done);n=!0){var v=t.value;v.apply({eventName:a},r)}}catch(m){o=!0,p=m}finally{try{!n&&u["return"]&&u["return"]()}finally{if(o)throw p}}return this}}]),a}();exports["default"]=Eventy,module.exports=exports["default"];